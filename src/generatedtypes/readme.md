## Open API Generated Zodios and Zod Objects

The `django_generated.ts` file is autogenerated via `pnpm run schema`. However you still must manually alter it:

- extract (copy/paste) and transform the `endpoints` variable into `/types/django_api.ts`. In the copy, we apply transforms for decimal strings and other one-offs as needed(\*).
- remove the createClientAPI stuff at the end. We don't use that.
- replace all `.passthrough()` to be `.strip()`.(\*\*)

## Other Limitations

There isn't an easy way to configure `openapi-zod-client` to import only the endpoints and schemas that we care about. For example, this frontend app is specifically for customers. We do not care about endpoints built for managers, delivery staff or administrators. We could also hack script this if we wanted but I'm not bothering in this PoC here (\*\*\*).

---

^(\*) The zodios types generated aren't perfect. The [openapi-zod-client](https://github.com/astahmer/openapi-zod-client) library doesn't transform string to numbers when it should. It doesn't use the appropriate read vs write variants of the schemas when it creates the endpoints. It misses other nuances.

^(\*\*) `.passthrough` allows additional fields to exist from API response w/o zod throwing validation errors. But it also keeps them around for the client and causes errors when trying to generate typescript types from these
zod objects. We switch it to `.strip()` manually so these additional fields are ignored and our types work fine.

^(\*\*\*) In some scenarios, using a tool like [openapi-endpoint-trimmer](https://github.com/andenacitelli/openapi-endpoint-trimmer) would work to reduce the schema doc. That works when there are specific endpoints we are/aren't interested in. However in this use case this app is geared to a specific authentication role-- customers. They have access to all endpoints but not to certain http methods (they are readonly).
